from __future__ import division
import numpy as np
from collections import Counter

def kneighbors(train, labels, test,k,p):
    predictedList = []
    for i in range(len(test)):
        print 'Predicting: ',(i +1),'/',len(test)
        differencePOWER = np.power((train - ([test[i],]*len(train))),p)
        sumdifferencePOWER = np.sum(differencePOWER, axis=1)
        distance = np.power(sumdifferencePOWER,(1/p))
        minIndices = np.argsort(distance)[:k]
        labelList = labels[minIndices]
        predictedList.append(  Counter(labelList).most_common(1)[0][0]  )
    return predictedList